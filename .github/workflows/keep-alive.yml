name: Keep Alive Service

on:
  schedule:
    # Ejecutar cada 10 minutos (Render se duerme despu√©s de 15 min de inactividad)
    - cron: '*/10 * * * *'
  workflow_dispatch: # Permite ejecutar manualmente desde GitHub

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Backend Health Check
        run: |
          echo "üèì Haciendo ping al backend..."
          
          # Reemplaza con tu URL de Render
          BACKEND_URL="${{ secrets.BACKEND_URL }}"
          
          if [ -z "$BACKEND_URL" ]; then
            echo "‚ö†Ô∏è  BACKEND_URL no est√° configurado en los secrets"
            exit 1
          fi
          
          # Hacer request al health check
          response=$(curl -s -o /dev/null -w "%{http_code}" "$BACKEND_URL/health")
          
          if [ $response -eq 200 ]; then
            echo "‚úÖ Backend est√° activo (Status: $response)"
          else
            echo "‚ö†Ô∏è  Backend respondi√≥ con status: $response"
            # No falla el job para que siga intentando en el pr√≥ximo cron
          fi
          
      - name: Log Activity
        run: |
          echo "üìä Keep-alive ejecutado exitosamente"
          echo "üïí Timestamp: $(date)"
